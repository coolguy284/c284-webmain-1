<!doctype html>
<html lang = 'en'>
  <head>
    <meta charset = 'utf-8'>
    
    <title>coolguy284.com: Juicy Queenbeet Hole-Punch Calculator</title>
    
    <meta name = 'viewport' content = 'width=device-width, initial-scale=1.0'>
    <meta name = 'description' content = 'Calculates optimal hole-punch locations for a 6x6 field of Queenbeets to maximize Juicy Queenbeet spawn chance ticks in the game Cookie Clicker.'>
    <meta name = 'keywords' content = 'Cookie Clicker, Juicy Queenbeet'>
    <meta name = 'author' content = 'coolguy284'>
    
    <link rel = 'canonical' href = 'https://coolguy284.com/debug/juicy_queenbeet_hole_punch.html'>
    
    <meta name = 'og:title' content = 'coolguy284.com: Juicy Queenbeet Hole-Punch Calculator'>
    <meta name = 'og:description' content = 'Calculates optimal hole-punch locations for a 6x6 field of Queenbeets to maximize Juicy Queenbeet spawn chance ticks in the game Cookie Clicker.'>
    <meta name = 'og:type' content = 'website'>
    <meta name = 'og:url' content = 'https://coolguy284.com/debug/juicy_queenbeet_hole_punch.html'>
    
    <link rel = 'stylesheet' href = '/libs/extern/bootstrap_5.0.0.min.css'>
    <style>
      textarea {
        font-family: monospace;
        height: 200px;
      }
    </style>
  </head>
  
  <body>
    <div class = 'container mt-3'>
      <noscript>
        <div class = 'alert alert-warning' role = 'alert' style = 'padding: 0.5rem 2rem 0.5rem;'>
          Note: This has obvious active components and thus requires JavaScript to function (JavaScript is disabled).
        </div>
      </noscript>
      
      <h1>Cookie Clicker Juicy Queenbeet Hole-Punch Calculator</h1>
      
      <p>Calculates optimal hole-punch locations for a 6x6 field of Queenbeets to maximize Juicy Queenbeet spawn chance ticks in the game Cookie Clicker.</p>
      
      <textarea id = 'input' class = 'form-control'></textarea>
      
      <br>
      
      <div class = 'form-check'>
        <label for = 'seedless_to_nay_gotten' class = 'form-check-label'>
          Seedless to Nay Achievement Gotten
        </label>
        
        <input type = 'checkbox' id = 'seedless_to_nay_gotten' class = 'form-check-input'>
      </div>
      
      <br>
      
      <button class = 'btn btn-primary'>Calculate</button>
      
      <p class = 'mt-3'>Results:</p>
      <p id = 'results'></p>
    </div>
    
    <script type = 'module'>
      // Next 2 constants might need to be incremented by 1
      
      /**
       * The length of ticks a Juicy Queenbeet is mature when the "Seedless to nay" achievment is not unlocked.
       */
      const JQB_MATURE_TICKS_NO_STN = 16; // Might be 17
      
      /**
       * The length of ticks a Juicy Queenbeet is mature when the "Seedless to nay" achievment is unlocked.
       */
      const JQB_MATURE_TICKS_STN = 19; // Might be 20
      
      /**
       * The [x, y] offsets that make up the Moore neighborhood of a point.
       */
      const MOORE_NEIGHBORHOOD_OFFSETS = [
        [-1, -1],
        [-1, 0],
        [-1, 1],
        [0, -1],
        [0, 1],
        [1, -1],
        [1, 0],
        [1, 1],
      ];
      
      /**
       * Parses a string containing Juicy Queenbeet age data into an intermediate representation.
       * 
       * @param jqbData the string containing Juicy Queenbeet age data. Format:
       * Rectangular grid of entries, seperated by spaces horizontally and newlines vertically.
       * Each entry is an integer representing garden ticks till next stage. If plant is in bloom phase, a "B" is prefixed to the integer.
       * 
       * @return {
       *   garden: Array<Integer>,
       *     Each entry in the array is the ticks till decay of a single Queenbeet in the garden. Array is 1-dimensional, and contents are left-to-right, top-to-bottom representation of garden.
       *   gardenWidth: integer,
       *     Width of the garden.
       * }
       */
      function parseJQBData(jqbData) {
        const garden2d =
          jqbData
            .split('\n')
            .map((line, index) => [index + 1, line]) // map to [line number, content]
            .filter(([_lineNumber, line]) => line != '')
            .map(
              ([lineNumber, line]) =>
                line
                  .split(/ +/g)
                  .filter(plantAgeData => plantAgeData != '')
                  .map(plantAgeData => {
                    let numberString;
                    let beforeMaturity;
                    
                    if (y.startsWith('B')) {
                      numberString = y.slice(1);
                      beforeMaturity = true;
                    } else {
                      numberString = y;
                      beforeMaturity = false;
                    }
                    
                    const ticksTillNextStage = Number(numberString);
                    
                    if (!Number.isSafeInteger(ticksTillNextStage)) {
                      throw new Error(`plantAgeData invalid: not small integer: ${JSON.stringify(ticksTillNextStage)}`);
                    }
                    
                    if (ticksTillNextStage < 0 || ticksTillNextStage > 99) {
                      throw new Error(`plantAgeData invalid: not in range: ${JSON.stringify(ticksTillNextStage)}`);
                    }
                    
                    return (beforeMaturity ? MATURE_TICKS : 0) + ticksTillNextStage;
                  })
            )
        
        return {
          garden: garden2d.flat(),
          gardenWidth: garden2d[0].length,
        }
      }
    </script>
  </body>
</html>
